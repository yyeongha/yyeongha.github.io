---
title : U-Net 논문리뷰_Convolutional Networks for Biomedical Image Segmentation
categories: [논문] 
date: 2024-08-26
last_modified_at: 2024-09-03
---
논문 출처 : [U-Net: Convolutional Networks for Biomedical Image Segmentation](https://arxiv.org/pdf/1505.04597)

## 1 Introduction
이 논문에서는 "완전 컨볼루션 네트워크(Fully Convolutional Network)" 라 불리는 구조를 기반으로 한다. 이 논문의 저자들은 Fully Convolutional Network를 수정하고 확장하여 매우 적은 수의 학습 이미지로도 동작하며, 더 정밀한 분할 결과를 얻을 수 있도록 했다.

<figure>
    <img src="이미지 URL" alt="fig1">
    <figcaption>U-net 구조는 32X32 픽셀의 최저 해상도를 예를 들어 설명한다. 각 파란색 박스는 다중채널(feature map)을 나타낸다. 박스 위에 표시된 숫자는 채널의 수를 나타내고, 박스의 왼쪽 하단 모서리에는 해당 feature map의 x-y 크기가 제공된다. 흰색 박스는 복사된 feature map을 나타내며, 화살표는 서로 다른 연산을 나타낸다</figcaption>
</figure>

주요 아이디어는 일반적인 수축 네트워크에 연속적인 레이어를 추가하는 것인데, 이때 풀링 연산자는 업샘플링 연산자로 대체된다. 따라서 이러한 레이어는 출력의 해상도를 증가시킨다. 
위치를 정확히 지정하기 위해서는 수축경로에서 얻은 고해상도 특징을 업샘플된 출력과 결합한다. 이후 연속적인 컨볼루션 레이어는 이 정보를 바탕으로 추력을 조합할 수 있게 학습된다.

이 구조에서 중요한 수정사항 중 하나는 업샘플링 부분에 많은 수의 특징 채널을 추가한 것이다.
이를 통해 네트워크는 컨텍스트 정보를 고해상도 레이어로 전달할 수 있다. 그 결과, 확장 경로는 수축 경로와 대칭적인 U자형 구조를 형성하게 된다.
이 네트워크는 완전 연결 레이어를 사용하지 않으며, 각 컨볼루션의 유효한 부분만 사용하여 세그멘테이션 맵에는 입력 이미지에서 전체 컨텍스트가 사용가능한 픽셀만 포함된다.
이러한 전략은 오버랩 타일 전략(Overlap-tile strategy, fig2 참조)을 통해 임의의 크기를 가진 이미지를 원활하게 분할할 수 있게 한다. 이미지 경계 영역의 픽셀을 예측하기 위해, 부족한 컨텍스트는 입력 이미지를 반전시켜 보완한다. 이러한 타일링 전략은 큰 이미지에 네트워크를 적용할때 매우 중요한데, 그렇지 않으면 GPU 메모리에 의해 해상도가 제한될 수 있기 때문이다.

<figure>
    <img src="이미지 URL" alt="fig2">
    <figcaption>오버랩 타일 전략은 임의의 크기를 가진 이미지를 원활하게 분할하기 위한 방법이다. 이 방법은 특히 전자현미경(EM)이미지 스택에서 신경 구조를 분할할 때 유용하다. 이 전략에서 특정 영역(ex)노란색 영역)의 세분화를 예측하려면 해당 영역 주위의 더 넓은 영역 (예)파란색영역)에 있는 이미지 데이터가 입력으로 필요하다.
    파란색 영역은 네트워크가 예측을 위해 필요한 전체 입력데이터를 포함한다. 그러나 이미지 경계에 가까운 경우, 필요한 입력데이터의 일부가 이미지 밖에 위치할 수 있다. 이때 부족한 입력 데이터를 보충하기 위해 이미지를 반전시켜 경계 바깥의 데이터를 추정한다. 이를 통해 이미지의 경계 근처에서도 정확한 세분화가 가능해지며, 네트워크는 큰 이미지에서도 끊김없이 세분화 작업을 수행할 수 있다.</figcaption>
</figure>

작업에서 사용할 수 있는 학습 데이터가 매우 적기 때문에, 학습 이미지에 탄성 변형을 적용하여 광범위한 데이터 증강을 사용했다. 이를 통해 네트워크는 주석이 달린 이미지 집합에서 이러한 변형을 직접보지 않고도 변형에 대한 불변성을 학습할 수 있다.
이것은 생의학 세분화에서 특히 중요한데, 조직에서 변형이 가장 흔한 변형 중 하나이기 때문이며, 이러한 현실적인 변형을 효율적으로 시뮬레이션 할 수 있기 때문이다.

또한 많은 세포 분할 작업에서 동일한 클래스에 속하는 서로 접촉하는 객체를 분리하는 것이 도전과제이다. (fig3 참조) 이를 해결하기 위해 서로 접촉하는 세포 사이의 분리 배경 레이블에 큰 가중치를 부여하는 가중 손실(weighted loss)을 사용할 것을 제안한다.

<figure>
    <img src="이미지 URL" alt="fig3">
    <figcaption>그림3은 DIC(차등 간섭 대비) 현미경으로 유리 위의 HeLa 세포를 촬영한 결과를 보여준다. 
    (a) 원본이미지: </figcaption>
</figure>














---
